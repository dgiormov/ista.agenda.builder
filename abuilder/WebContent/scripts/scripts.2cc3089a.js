"use strict";angular.module("istaAngularApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/days/:id",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/sessions/:id",{templateUrl:"views/sessiondetails.html",controller:"DetailsCtrl"}).when("/codes",{templateUrl:"views/codes.html",controller:"CodesCtrl"}).when("/ranking",{templateUrl:"views/ranking.html",controller:"RankingCtrl"}).when("/ranking/:id",{templateUrl:"views/ratingdetails.html",controller:"RatingDetailsCtrl"}).when("/achievements",{templateUrl:"views/achievements.html",controller:"AchievementsCtrl"}).otherwise({redirectTo:"/days/27"})}]).controller("LoginCtrl",["$scope","UserService",function(a,b){a.userDetails=b.get(function(a){a.hasCookie&&!a.isLogged&&(window.location="authorize?provider=auto")})}]).controller("wellcomeModalCtrl",["$scope","$cookies",function(a,b){a.showLogin=!1,b.hideWellcome||$("#wellcomeModal").modal("show"),a.goToLogin=function(){a.showLogin=!0,b.hideWellcome=!0},a.hide=function(){b.hideWellcome=!0}}]).config(["$httpProvider",function(a){a.interceptors.push(["$rootScope","$q",function(a,b){return{responseError:function(a){switch(a.status){case 401:var c=b.defer();return $("#loginModal").modal("show"),c.promise;case 403:$("#loginModal").modal("show");break;case 400:case 405:case 406:case 409:case 412:case 428:$("#mTitle").html("Error"),$("#mDesc").html(a.data.message),$("#messageModal").modal("show")}return b.reject(a)}}}])}]),jQuery(document).ready(function(){jQuery("#navbar-ex1-collapse").click(function(){jQuery("#navbar-ex1-collapse.in").collapse("hide")})}),angular.module("istaAngularApp").controller("MainCtrl",["$scope","$routeParams","session","PersonService",function(a,b,c,d){a.selected=!1,a.sessions=c.query({date:b.id}),a.rotating=new Array,a.addSession=function(b,c,e){c.preventDefault(),(new d).$save({id:b.id,isSelected:!b.isSelected},function(){a.rotating[e]="",b.isSelected=!b.isSelected},function(){a.rotating[e]=""}),a.rotating[e]="fa-spin fa-spinner"},a.isSelected=function(a){return a?"session-added":"not-added"},a.filterSessions=function(b){a.selected=b},a.getSelectedAgendaClass=function(b){return a.selected&&b||!a.selected&&!b?"panel-link-active":""},a.getTrackClass=function(a){return a.replace(" ","-").toLowerCase()},a.lTime=0,a.isChangedTime=function(b){return a.lTime!=b?(a.lTime=b,!0):!1},a.isRotating=function(b){return a.rotating[b]}}]).filter("isSelectedElement",function(){return function(a,b){if(!b)return a;for(var c=[],d=0;d<a.length;d++)a[d].isSelected&&c.push(a[d]);return c}}),angular.module("istaAngularApp").controller("DetailsCtrl",["$scope","$routeParams","sessionDetails","sessionComments","sessionCommentsLike","RatingService","SpeakerRatingService","PersonService","shareService",function(a,b,c,d,e,f,g,h,i){a.session=c.get({id:b.id},function(){for(var b=a.session.speakers,c=0;c<b.length;c++)a.bioStatus[c]="description-collapsed"}),a.addSession=function(a){(new h).$save({id:a.id,isSelected:!a.isSelected},function(){a.isSelected=!a.isSelected},function(){})},a.refreshComments=function(){a.comments=d.query({session_id:b.id}),a.comment=""},a.refreshComments(),a.postComment=function(){d.save({session_id:b.id},{data:a.comment},function(){a.refreshComments()},function(){})},a.rateSession=function(b,c){(new f).$save({sessionId:c.id,rating:b},function(){a.session.rating=b},function(){a.session.rating=0})},a.rateSpeaker=function(b,c){(new g).$save({sessionId:c.id,rating:b},function(){a.session.speakerRating=b},function(){a.session.speakerRating=0})},a.like=function(a){e.save({id:a.id},{},function(){a.likedByMe=!a.likedByMe,a.likes=a.likedByMe?a.likes+1:a.likes-1},function(){})},a.share=function(){i.get()},a.descrClass="description-collapsed",a.bioStatus=new Array,a.getSpeakerStarClass=function(b){return b<=a.session.speakerRating?"yes-rated":"not-rated"},a.getSessionStarClass=function(b){return b<=a.session.rating?"yes-rated":"not-rated"},a.isAdded=function(b){return a.session.isSelected?b?"session-added":"fa-check":b?"not-added":"fa-plus"},a.getTrackClass=function(a){return a.$resolved?a.track.replace(" ","-").toLowerCase():""},a.expandColapse=function(){a.descrClass="description-expanded"===a.descrClass?"description-collapsed":"description-expanded"},a.expandColapseBio=function(b){a.bioStatus[b]="description-expanded"===a.bioStatus[b]?"description-collapsed":"description-expanded"},a.getBioClass=function(b){return a.bioStatus[b]}}]),angular.module("istaAngularApp").controller("AchievementsCtrl",["$scope","achievements",function(){}]),angular.module("istaAngularApp").controller("CodesCtrl",["$scope",function(){}]),angular.module("istaAngularApp").controller("RankingCtrl",["$scope","ranking","codes",function(a,b,c){a.allRanking=b.get(),a.code="",a.enterCode=function(){c.save({},{code:a.code},function(){})}}]),angular.module("istaAngularApp").controller("RatingDetailsCtrl",["$scope",function(){}]),angular.module("istaAngularApp").service("session",["$resource",function(a){return a("rest/sessions")}]).service("PersonService",["$resource",function(a){return a("rest/book/session")}]),angular.module("istaAngularApp").service("sessionDetails",["$resource",function(a){return a("rest/sessions/:id")}]).service("RatingService",["$resource",function(a){return a("rest/rating/session")}]).service("SpeakerRatingService",["$resource",function(a){return a("rest/rating/speaker")}]).service("shareService",["$resource",function(a){return a("rest/share")}]),angular.module("istaAngularApp").service("achievements",["$resource",function(a){return a("rest/achievements")}]),angular.module("istaAngularApp").service("UserService",["$resource",function(a){return a("/rest/user")}]),angular.module("istaAngularApp").service("sessionComments",["$resource",function(a){return a("/rest/comments/:session_id")}]).service("sessionCommentsLike",["$resource",function(a){return a("/rest/comments/:id/like")}]),angular.module("istaAngularApp").service("codes",["$resource",function(a){return a("rest/codes")}]),angular.module("istaAngularApp").service("ranking",["$resource",function(a){return a("/rest/ranking")}]),angular.module("istaAngularApp").directive("backButton",function(){return{restrict:"E",template:'<div class="add-session session-added"><i class="fa fa-chevron-left"></i></div>',link:function(a,b){b.bind("click",function(){history.back(),a.$apply()})}}});