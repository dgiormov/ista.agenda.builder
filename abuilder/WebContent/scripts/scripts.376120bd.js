"use strict";angular.module("istaAngularApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/days/:id",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/sessions/:id",{templateUrl:"views/sessiondetails.html",controller:"DetailsCtrl"}).when("/codes",{templateUrl:"views/codes.html",controller:"CodesCtrl"}).when("/ranking",{templateUrl:"views/ranking.html",controller:"RankingCtrl"}).when("/feedback",{templateUrl:"views/feedback.html",controller:"FeedbackCtrl"}).when("/ranking/:id",{templateUrl:"views/rankingdetails.html",controller:"RankingDetailsCtrl"}).when("/achievements",{templateUrl:"views/achievements.html",controller:"AchievementsCtrl"}).when("/top",{templateUrl:"views/topsessions.html",controller:"TopSessionCtrl"}).when("/welcome",{templateUrl:"views/welcome.html",controller:"WelcomeModalCtrl"}).when("/partners",{templateUrl:"views/partners.html"}).when("/ranking_public",{templateUrl:"views/ranking_public.html",controller:"RankingCtrl"}).otherwise({redirectTo:function(){var a=26===(new Date).getDate()?26:27;return"/days/"+a}})}]).run(["$cookies","$location",function(a,b){a.hideWellcome||b.path("/welcome")}]).controller("LoginCtrl",["$scope","UserService",function(a,b){a.userDetails=b.get(function(a){a.hasCookie&&!a.isLogged&&(window.location="authorize?provider=auto")})}]).config(["$httpProvider",function(a){a.interceptors.push(["$rootScope","$q",function(a,b){return{responseError:function(a){switch(a.status){case 401:var c=b.defer();return $("#loginModal").modal("show"),c.promise;case 403:$("#loginModal").modal("show");break;case 400:case 405:case 406:case 409:case 412:case 428:"undefined"!=typeof a.data.message&&($("#mTitle").html("Error"),$("#mDesc").html(a.data.message),$("#messageModal").modal("show"))}return b.reject(a)}}}])}]),jQuery(document).ready(function(){jQuery("#navbar-ex1-collapse").click(function(){jQuery("#navbar-ex1-collapse.in").collapse("hide")})}),angular.module("istaAngularApp").controller("MainCtrl",["$scope","$routeParams","session","PersonService",function(a,b,c,d){a.selected=!1,a.sessions=c.query({date:b.id}),a.rotating=[],a.addSession=function(b,c,e){c.preventDefault(),(new d).$save({id:b.id,isSelected:!b.isSelected},function(){a.rotating[e]="",b.isSelected=!b.isSelected},function(){a.rotating[e]=""}),a.rotating[e]="fa-spin fa-spinner"},a.isSelected=function(a){return a?"session-added":"not-added"},a.filterSessions=function(b){a.selected=b},a.getSelectedAgendaClass=function(b){return a.selected&&b||!a.selected&&!b?"panel-link-active":""},a.getTrackClass=function(a){return a.replace(" ","-").toLowerCase()},a.lTime=0,a.isChangedTime=function(b){return a.lTime!==b?(a.lTime=b,!0):!1},a.isRotating=function(b){return a.rotating[b]}}]).filter("isSelectedElement",function(){return function(a,b){if(!b)return a;for(var c=[],d=0;d<a.length;d++)a[d].isSelected&&c.push(a[d]);return c}}),angular.module("istaAngularApp").controller("DetailsCtrl",["$scope","$routeParams","sessionDetails","sessionComments","sessionCommentsLike","RatingService","SpeakerRatingService","PersonService","shareService","$location",function(a,b,c,d,e,f,g,h,i,j){a.host="Speaker",a.bareArticleUrl=j.path(),a.articleUrl=encodeURI(j.absUrl()),a.session=c.get({id:b.id},function(){var b=a.session.speakers;b.length>1?a.host="Speakers":1===b.length&&"Organizers"===b[0].name&&(a.host="Staff");for(var c=0;c<b.length;c++)a.bioStatus[c]="description-collapsed"}),a.addSession=function(a){(new h).$save({id:a.id,isSelected:!a.isSelected},function(){a.isSelected=!a.isSelected},function(){})},a.refreshComments=function(){a.comments=d.query({session_id:b.id}),a.comment=""},a.refreshComments(),a.postComment=function(){d.save({session_id:b.id},{data:a.comment},function(){a.refreshComments()},function(){})},a.rateSession=function(b,c){(new f).$save({sessionId:c.id,rating:b},function(){a.session.rating=b},function(){a.session.rating=0})},a.rateSpeaker=function(b,c){(new g).$save({sessionId:c.id,rating:b},function(){a.session.speakerRating=b},function(){a.session.speakerRating=0})},a.like=function(a){e.save({id:a.id},{},function(){a.likedByMe=!a.likedByMe,a.likes=a.likedByMe?a.likes+1:a.likes-1},function(){})},a.share=function(){i.get()},a.descrClass="description-collapsed",a.bioStatus=[],a.getSpeakerStarClass=function(b){return b<=a.session.speakerRating?"yes-rated":"not-rated"},a.getSessionStarClass=function(b){return b<=a.session.rating?"yes-rated":"not-rated"},a.isAdded=function(b){return a.session.isSelected?b?"session-added":"fa-check":b?"not-added":"fa-plus"},a.getTrackClass=function(a){return a.$resolved?a.track.replace(" ","-").toLowerCase():""},a.expandColapse=function(){a.descrClass="description-expanded"===a.descrClass?"description-collapsed":"description-expanded"},a.expandColapseBio=function(b){a.bioStatus[b]="description-expanded"===a.bioStatus[b]?"description-collapsed":"description-expanded"},a.getBioClass=function(b){return a.bioStatus[b]},a.hasPicture=function(a){return!("undefined"===a.picture||""===a.picture)}}]),angular.module("istaAngularApp").controller("AchievementsCtrl",["$scope","achievements",function(a,b){a.myAchievements=b.get(),a.help=function(a){var b="";switch(a){case"login":b="Login";break;case"prepare":b="Prepare for the conference by selecting, which sessions you will attend.";break;case"share":b="Share your experience in social networks. (Share buttons are in session details)";break;case"rate":b="Rate session or speaker.";break;case"comment":b="Place a comment in some session slot.";break;case"top100":b="Manage to get in Top 100 in our leaderboard.";break;case"liked5":b="Recieve 5+ likes on comment you have posted.";break;case"fillupsurvey":b="Give us some feedback for the conference";break;case"tshirt":b="Help our charity cause, buy a T-Shirt and enter the code in the application."}$("#mTitle").html("To win this achievement you have to:"),$("#mDesc").html(b),$("#messageModal").modal("show")},a.getCss=function(b,c,d){return 1===b?"undefined"===a.myAchievements.rank1?.5:-1===$.inArray(c,a.myAchievements.rank1)?.5:1:2===b?"undefined"===a.myAchievements.rank2?.5:-1===$.inArray(c,a.myAchievements.rank2)?"undefined"===d?.5:-1===$.inArray(d,a.myAchievements.rank2)?.5:1:1:3===b?"undefined"===a.myAchievements.rank3?.5:-1===$.inArray(c,a.myAchievements.rank3)?.5:1:void 0}}]),angular.module("istaAngularApp").controller("CodesCtrl",["$scope","challenge",function(a,b){a.tittle="Unlock the challenge by reaching Gold User status !",a.description="",a.counter=0,a.counterInPercents=0,a.imgurl="images/challenge/baby.png",a.challenge=b.get(function(){a.challenge.rank>1&&(a.challenge.unlocked?(a.challenge.code?(a.tittle="Well done, you have completed the challenge",a.imgurl="images/challenge/charity.jpg",a.counter=a.challenge.counter,a.counterInPercents=a.challenge.counter/2,a.counterInPercents>100&&(a.counterInPercents=100)):(a.tittle="Challenge started",a.imgurl="images/challenge/charity.jpg",a.counter=a.challenge.counter,a.counterInPercents=a.challenge.counter/2,a.counterInPercents>100&&(a.counterInPercents=100)),a.challenge.counter>200&&(a.tittle="Additional donation unlocked",a.imgurl="images/challenge/ista3.jpg")):(a.tittle="You can unlock the challenge now.",a.imgurl="images/challenge/treasure-map.png",a.counter="",a.counterInPercents=""))}),a.goldAndUnlocked=function(){return a.challenge.rank>1&&a.challenge.unlocked&&!a.challenge.code},a.goldAndLocked=function(){return a.challenge.rank>1&&!a.challenge.unlocked},a.goldAndFinished=function(){return a.challenge.rank>1&&a.challenge.unlocked&&a.challenge.code&&a.challenge.counter<200},a.finito=function(){return a.challenge.rank>1&&a.challenge.unlocked&&a.challenge.code&&a.challenge.counter>=200}}]),angular.module("istaAngularApp").controller("RankingCtrl",["$scope","ranking","codes",function(a,b,c){a.refreshLeaderboard=function(){a.allRanking=b.get()},a.refreshLeaderboard(),a.code="",a.enterCode=function(){c.save({},{code:a.code},function(b){a.code="",$("#mTitle").html("Congratulations"),$("#mDesc").html("You have won: "+b.points+" points."),$("#messageModal").modal("show"),a.refreshLeaderboard()})}}]),angular.module("istaAngularApp").controller("RankingDetailsCtrl",["$scope","ranking","$routeParams",function(a,b,c){a.player=b.get({id:c.id})}]),angular.module("istaAngularApp").controller("FeedbackCtrl",["$scope","feedback",function(){}]),angular.module("istaAngularApp").controller("TopSessionCtrl",["$scope","topsession","topspeaker",function(a,b,c){a.speakers=c.query({}),a.sessions=b.query({}),a.getStar=function(a,b){return b>=a?"fa-star":a>b&&b>a-1?"fa-star-half-o":"fa-star-o"}}]),angular.module("istaAngularApp").controller("WelcomeModalCtrl",["$scope","$cookies","$location",function(a,b,c){a.showLogin=!1,$("#wellcomeModal").modal("show"),a.goToLogin=function(){a.showLogin=!0,b.hideWellcome=!0},a.hide=function(){$(".modal-backdrop.fade.in").remove(),b.hideWellcome=!0,c.path("/")}}]),angular.module("istaAngularApp").service("topsession",["$resource",function(a){return a("/rest/stats/session")}]).service("topspeaker",["$resource",function(a){return a("/rest/stats/speaker")}]),angular.module("istaAngularApp").service("session",["$resource",function(a){return a("rest/sessions")}]).service("PersonService",["$resource",function(a){return a("rest/book/session")}]),angular.module("istaAngularApp").service("sessionDetails",["$resource",function(a){return a("rest/sessions/:id")}]).service("RatingService",["$resource",function(a){return a("rest/rating/session")}]).service("SpeakerRatingService",["$resource",function(a){return a("rest/rating/speaker")}]).service("shareService",["$resource",function(a){return a("rest/me/share")}]),angular.module("istaAngularApp").service("achievements",["$resource",function(a){return a("rest/me/achievements")}]),angular.module("istaAngularApp").service("UserService",["$resource",function(a){return a("/rest/user")}]),angular.module("istaAngularApp").service("sessionComments",["$resource",function(a){return a("/rest/comments/:session_id")}]).service("sessionCommentsLike",["$resource",function(a){return a("/rest/comments/:id/like")}]),angular.module("istaAngularApp").service("codes",["$resource",function(a){return a("rest/codes")}]).service("challenge",["$resource",function(a){return a("rest/me/challenge")}]),angular.module("istaAngularApp").service("ranking",["$resource",function(a){return a("/rest/ranking/:id")}]),angular.module("istaAngularApp").service("feedback",["$resource",function(a){return a("rest/me/feedback")}]),angular.module("istaAngularApp").directive("backButton",function(){return{restrict:"E",template:'<div class="add-session session-added"><i class="fa fa-chevron-left"></i>Back</div>',link:function(a,b){b.bind("click",function(){history.back(),a.$apply()})}}});